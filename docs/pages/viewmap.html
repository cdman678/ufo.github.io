<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">

<head>
    <meta charset="utf-8">
    <title>Heatmaps</title>

    <!-- async defer This is using caleb's key -->
    <script defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDdB87i_oB26YONYbfPGhm4wAlJk3jYO94&libraries=visualization&callback=initMap" type="text/javascript">
    </script>

    <script src="javascript/RGraph/libraries/RGraph.common.csv.js"> </script>

    <style>
        /* Always set the map height explicitly to define the size of the div
         * element that contains the map. */
        #map {
            height: 100%;
        }
        /* Optional: Makes the sample page fill the window. */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>

<div id="map"></div>
<script>

    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    var map, heatmap;

    function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
            zoom: 5,
            center: {lat: 39.8283, lng: -98.5795},
            mapTypeId: 'terrain'
        });

        heatmap = new google.maps.visualization.HeatmapLayer({
            data: getPoints(),
            map: map
        });
    }

    var csv = new RGraph.CSV('../data/condesnedcountlong.csv', function (csv) {
        // Get the first column which becomes the labels
        var lat = csv.getCol(0);
        // Get the second column which becomes the data
        var long = csv.getCol(1);
        // Get weight
        var weight = csv.getCol(2);
    });

    function getPoints() {
        var cords = [];
        var commands = [];
        sleep(10000).then(()=>{});
        for (var j = 0; j < csv.data.length; j++) {
            cords[j] = [];
            cords[j].push(csv.data[j][0]);
            cords[j].push(csv.data[j][1]);
            cords[j].push(csv.data[j][2]);
            commands.push({location: new google.maps.LatLng(cords[j][0], cords[j][1]), weight: cords[j][2]})
            //commands.push(new google.maps.LatLng(cords[j][0], cords[j][1]));
        }
        return commands;
    }
</script>

</body>

</html>